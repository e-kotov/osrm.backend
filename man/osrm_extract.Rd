% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/osrm_extract.R
\name{osrm_extract}
\alias{osrm_extract}
\title{Extract OSM into OSRM Graph Files}
\usage{
osrm_extract(
  input_osm,
  profile = osrm_find_profile("car.lua"),
  threads = 8L,
  overwrite = FALSE,
  verbosity = c("INFO", "NONE", "ERROR", "WARNING", "DEBUG"),
  data_version = NULL,
  small_component_size = 1000L,
  with_osm_metadata = FALSE,
  parse_conditional_restrictions = FALSE,
  location_dependent_data = NULL,
  disable_location_cache = FALSE,
  dump_nbg_graph = FALSE,
  echo_cmd = FALSE,
  echo = TRUE,
  spinner = TRUE
)
}
\arguments{
\item{input_osm}{A string. Path to the input OSM file:
\code{.osm}, \code{.osm.bz2}, or \code{.osm.pbf}.}

\item{profile}{A string. Path to the OSRM Lua profile
(e.g. returned by \code{osrm_find_profile("car.lua")}).}

\item{threads}{An integer. Number of threads for
\code{-t/--threads}; default \code{8} (OSRM's default).}

\item{overwrite}{A logical. If \code{FALSE} (default), stops when any
existing \verb{.osrm*} files matching the base name are found alongside
\code{input_osm}. Set to \code{TRUE} to proceed regardless.}

\item{verbosity}{A string. Log verbosity level passed to
\code{-l/--verbosity} (one of \code{"NONE","ERROR","WARNING","INFO","DEBUG"}),
default \code{"INFO"}.}

\item{data_version}{A string or \code{NULL}. Passed to
\code{-d/--data_version}; default \code{NULL}, in which case the option
is omitted.}

\item{small_component_size}{An integer. For
\code{--small-component-size}; default \code{1000} (OSRM's default).}

\item{with_osm_metadata}{A logical. If \code{TRUE}, adds
\code{--with-osm-metadata}; default \code{FALSE}.}

\item{parse_conditional_restrictions}{A logical. If \code{TRUE}, adds
\code{--parse-conditional-restrictions}; default \code{FALSE}.}

\item{location_dependent_data}{A string or \code{NULL}. Path to GeoJSON,
passed to \code{--location-dependent-data}; default \code{NULL}, in which
case the option is omitted.}

\item{disable_location_cache}{A logical. If \code{TRUE}, adds
\code{--disable-location-cache}; default \code{FALSE}.}

\item{dump_nbg_graph}{A logical. If \code{TRUE}, adds
\code{--dump-nbg-graph}; default \code{FALSE}.}

\item{echo_cmd}{A logical. Print each command before running; default \code{FALSE}.}

\item{echo}{A logical. Stream stdout/stderr; default \code{TRUE}.}

\item{spinner}{A logical. Show spinner instead of live logs; default \code{TRUE}.}
}
\value{
A list with two elements:
\describe{
\item{osrm_path}{The expected path to the generated \code{.osrm} base,
i.e. the timestamp file path with \code{.timestamp} dropped.}
\item{logs}{The \code{processx::run} result object.}
}
}
\description{
Run the \code{osrm-extract} tool to preprocess an OSM file
(\code{.osm}, \code{.osm.bz2}, or \code{.osm.pbf}) into the base \code{.osrm} graph files
using a specified Lua profile.  After running, a companion
\verb{<base>.osrm.timestamp} file must exist to confirm success.
}
\examples{
\donttest{
# install osrm and set up PATH for the session
osrm_executable <- osrm_install(
 version = "v5.27.1",
 path_action = "session"
)
# copy example OSM PBF into a temporary workspace to avoid polluting pkg data
workspace <- tempdir()
tmp_prefix <- file.path(workspace, paste0("osrm-example-", Sys.getpid()))
pbf_path <- system.file("extdata/cur.osm.pbf", package = "osrm.backend")
tmp_pbf <- paste0(tmp_prefix, ".osm.pbf")
file.copy(pbf_path, tmp_pbf, overwrite = TRUE)
# extract OSRM graph files
result <- osrm_extract(
  input_osm                  = tmp_pbf,
  profile                    = osrm_find_profile("car.lua"),
  overwrite                  = TRUE,
  threads                    = 1L
)
# path to generated .osrm files (specifically, the .osrm.timestamp file)
result$osrm_path
# clean up the temporary workspace
unlink(workspace, recursive = TRUE)
}
}
